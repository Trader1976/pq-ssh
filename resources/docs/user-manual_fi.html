<!doctype html>
<html lang="fi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>CPUNK PQ-SSH — Käyttöohje</title>
    <meta name="description" content="CPUNK PQ-SSH -käyttöohje (profiilipohjainen SSH-asiakas, PQ-tila, asetukset, tiedostonsiirto, makrot ja lokitus)." />

    <!-- IMPORTANT for QTextBrowser + QRC -->
    <link rel="stylesheet" href="qrc:/docs/user-manual.css" />

    <!-- Force User Manual to always look like Windows Classic -->
    <style>
        :root { color-scheme: light; }
        html, body {
            background: #ffffff !important;
            color: #000000 !important;
        }

        /* Neutralize any inherited/global theme styling */
        * {
            background-color: transparent;
            color: inherit;
            border-color: #b0b0b0;
        }

        /* Manual layout primitives */
        .top, .card, .callout, .note, .tip, .warn, .footer, .figure, .hero, .pill {
            background: #ffffff !important;
            color: #000000 !important;
            border: 1px solid #b0b0b0 !important;
            box-shadow: none !important;
            border-radius: 0 !important;
        }

        .wrap { max-width: 980px; }

        .logo {
            background: #e6e6e6 !important;
            color: #000 !important;
            border: 1px solid #b0b0b0 !important;
            border-radius: 0 !important;
        }

        .btn {
            display: inline-block;
            background: #e6e6e6 !important;
            color: #000 !important;
            border: 1px solid #808080 !important;
            border-radius: 0 !important;
            box-shadow: none !important;
            text-decoration: none !important;
            padding: 5px 10px;
            margin: 0 6px 6px 0;
            white-space: nowrap;
        }
        .btn:hover { filter: none !important; }

        code, pre, .codeblock {
            background: #f3f3f3 !important;
            color: #000 !important;
            border: 1px solid #b0b0b0 !important;
            box-shadow: none !important;
        }

        .muted { color: #333 !important; }

        /* ---- QTextBrowser-friendly layout helpers (NO flex/grid) ---- */

        /* Make nav look like real "button bar" */
        .nav {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #b0b0b0;
        }

        /* Intro hero block */
        .hero {
            padding: 12px 12px 10px 12px;
            margin: 0 0 12px 0;
        }
        .hero h2 { margin-top: 0; }

        /* Callouts as reliable "cards" (inline-block) */
        .callouts { margin-top: 10px; }
        .callout {
            display: inline-block;
            vertical-align: top;
            width: 215px;           /* tune to match your window width */
            margin: 6px 10px 6px 0;
            padding: 10px 10px 8px 10px;
        }
        .callout-title {
            font-weight: bold;
            margin-bottom: 6px;
        }

        /* Two-column section (table is most reliable in QTextBrowser) */
        table.twocol {
            width: 100%;
            border-collapse: separate;
            border-spacing: 10px;
            margin: 8px 0 0 0;
        }
        table.twocol td {
            vertical-align: top;
        }
        td.colText { width: 60%; }
        td.colImg  { width: 40%; }

        /* Figure (screenshot) blocks */
        .figure {
            padding: 8px;
            margin: 0;
        }
        .figure img {
            display: block;
            max-width: 100%;
            border: 1px solid #808080;
        }
        .figcap {
            margin-top: 6px;
            font-size: 90%;
            color: #333;
        }

        /* Small badge pills */
        .pill {
            display: inline-block;
            border: 1px solid #808080 !important;
            background: #e6e6e6 !important;
            padding: 2px 6px;
            margin-right: 6px;
        }

        /* Make details/summary a bit clearer */
        details summary {
            cursor: pointer;
            padding: 4px 0;
        }

        /* Tighten sections */
        .card { padding: 12px 14px; }
        .card h2 { margin-top: 0; }

        /* --- Readability spacing (Windows Classic friendly) --- */

        /* Space between cards (Getting started, Profiles, Connect...) */
        main.content > section.card { margin: 0 0 16px 0; }

        /* Paragraph spacing inside cards */
        .card p { margin: 10px 0; line-height: 1.45; }

        /* Lists */
        .card ul, .card ol { margin: 10px 0 12px 22px; }

        /* Headings inside cards: spacing ABOVE headings, not huge */
        .card h2 { margin: 50px 0 12px 0; }
        .card h3 { margin: 18px 0 8px 0; }
        .card h4 { margin: 14px 0 6px 0; }

        /* Notes/tips/warnings */
        .note, .tip, .warn { margin: 12px 0; padding: 10px 12px; }

        /* Code blocks */
        pre, .codeblock { margin: 10px 0 12px 0; padding: 10px; }

        /* Troubleshooting details spacing */
        details { margin: 10px 0; }
    </style>
</head>

<body>
<header class="top">
    <div class="wrap">
        <div class="brand">
            <div class="logo" aria-hidden="true">CP</div>
            <div>
                <h1>CPUNK PQ-SSH</h1>
                <p class="subtitle">Käyttöohje</p>
            </div>
        </div>

        <nav class="nav" aria-label="Käyttöohjeen navigointi">
            <a class="btn" href="#getting-started">Aloitus</a>
            <a class="btn" href="#profiles">Profiilit</a>
            <a class="btn" href="#connect">Yhdistä</a>
            <a class="btn" href="#fleet-jobs">Laajotyöt</a>
            <a class="btn" href="#scheduled-jobs">Ajastetut työt</a>
            <a class="btn" href="#macros">Makrot</a>
            <a class="btn" href="#settings">Asetukset</a>
            <a class="btn" href="#themes">Teemat</a>
            <a class="btn" href="#file-transfer">Tiedostonsiirto</a>
            <a class="btn" href="#pq-status">PQ-tila</a>
            <a class="btn" href="#key-install">Avaimen asennus</a>
            <a class="btn" href="#logging">Lokitus</a>
            <a class="btn" href="#troubleshooting">Vianmääritys</a>
        </nav>
    </div>
</header>

<main class="wrap content">

    <!-- Intro -->
    <section class="card intro">
        <div class="hero">
            <h2>Mikä PQ-SSH on</h2>
            <p>
                <b>CPUNK PQ-SSH</b> on profiilipohjainen SSH-asiakas, joka keskittyy siistiin terminaalityöskentelyyn,
                vahvoihin tietoturvaoletuksiin ja <b>post-kvanttivalmiuden (PQ) tilailmaisimeen</b>.
            </p>

            <div>
                <span class="pill">Terminaali ensin</span>
                <span class="pill">Profiilit</span>
                <span class="pill">Makrot</span>
                <span class="pill">SFTP</span>
                <span class="pill">Audit-lokitus</span>
            </div>

            <div class="callouts">
                <div class="callout">
                    <div class="callout-title">Terminaali ensin</div>
                    <p>Yhteydet avautuvat oikeaan SSH-terminaaliin, jota käyttää järjestelmäsi OpenSSH.</p>
                </div>
                <div class="callout">
                    <div class="callout-title">Profiilit</div>
                    <p>Tallenna host/käyttäjä/portti ja asetukset. Yhdistä yhdellä klikkauksella.</p>
                </div>
                <div class="callout">
                    <div class="callout-title">Makrot</div>
                    <p>Sido pikanäppäimet komentoihin ja lähetä ne aktiiviseen SSH-terminaaliin heti.</p>
                </div>
                <div class="callout">
                    <div class="callout-title">SFTP-työnkulut</div>
                    <p>Valinnainen libssh-istunto mahdollistaa selaamisen ja tiedostosiirrot rikkomatta terminaalikokemusta.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="getting-started" class="card">
        <h2>Aloitus</h2>
        <ol>
            <li>Avaa <b>PQ-SSH</b>.</li>
            <li>Napsauta <b>Muokkaa profiileja…</b>.</li>
            <li>Luo profiili (Nimi, Käyttäjä, Host/IP, Portti).</li>
            <li>Valitse profiili ja napsauta <b>Yhdistä</b> (tai tuplaklikkaa profiilia).</li>
        </ol>

        <div class="note">
            <b>Oletustoiminta:</b> “Avaa uusi yhteys UUTEEN ikkunaan” on käytössä, joten jokainen yhteys avautuu erikseen.
        </div>
    </section>

    <section id="profiles" class="card">
        <h2>Profiilit</h2>

        <table class="twocol" role="presentation">
            <tr>
                <td class="colText">
                    <p>Profiili tallentaa yhteyden tiedot ja käyttöliittymän asetukset:</p>
                    <ul class="bullets">
                        <li><b>Nimi</b> — selkeä nimi (esim. “Palvelin#1”)</li>
                        <li><b>Käyttäjä</b> — SSH-käyttäjänimi (esim. <code>root</code>)</li>
                        <li><b>Host</b> — isäntänimi tai IP (esim. <code>192.168.0.1</code>)</li>
                        <li><b>Portti</b> — oletus on <code>22</code></li>
                        <li><b>Ryhmä</b> — valinnainen tunniste profiilien järjestelyyn listassa</li>
                        <li><b>Avaintyyppi</b> — yleensä <code>auto</code> tai <code>openssh</code></li>
                        <li><b>Terminaaliteema</b> — terminaalin väriteema</li>
                        <li><b>Pikanäppäinmakrot</b> — profiilikohtainen makrolista (pikanäppäin → komento)</li>
                    </ul>

                    <div class="tip">
                        Vinkki: Pidä profiilinimet lyhyinä ja yhdenmukaisina (Prod, Staging, Home, jne.) ja käytä ryhmiä, jotta lista pysyy luettavana.
                    </div>
                </td>

                <td class="colImg">
                    <div class="figure">
                        <img src="qrc:/docs/img/profilemanager.png" alt="Profiilihallinta" width="450"/>
                        <div class="figcap"><b>Profiilihallinta</b> — luo ja järjestä profiileja (lisäasetuksilla).</div>
                    </div>
                </td>
            </tr>
        </table>

        <!-- Port forwarding -->
        <h3 id="port-forwarding">Porttiohjaus (tunnelointi)</h3>
        <p>
            PQ-SSH tukee <b>profiilikohtaista porttiohjausta</b>. Tämän avulla voit “tunneloida” TCP-liikennettä turvallisesti SSH-yhteyden läpi.
            Voit ottaa käyttöön useita ohjaussääntöjä samassa profiilissa (multi-forward).
        </p>

        <h4>Mistä se asetetaan</h4>
        <ol>
            <li>Avaa <b>Muokkaa profiileja…</b></li>
            <li>Valitse profiili</li>
            <li>Avaa keskisarakkeesta <b>Lisäasetukset</b></li>
            <li>Ota käyttöön <b>Ota porttiohjaus käyttöön</b></li>
            <li>Napsauta <b>Porttiohjaus…</b> lisätäksesi/muokataksesi sääntöjä</li>
        </ol>

        <h4>Ohjaustyypit</h4>
        <ul class="bullets">
            <li>
                <b>Paikallinen ohjaus (-L)</b> — ohjaa koneesi paikallisen portin kohdehostiin/-porttiin etäpäässä.
                <div class="note">
                    Esimerkki: käytä etäpalvelua paikallisesti:
                    <pre class="codeblock"><code>ssh -L 127.0.0.1:18888:localhost:18080 user@server</code></pre>
                    Selaa/curl:
                    <pre class="codeblock"><code>curl http://127.0.0.1:18888/</code></pre>
                </div>
            </li>
            <li>
                <b>Etäohjaus (-R)</b> — ohjaa etäpalvelimen portin takaisin paikalliseen kohteeseen (johon etäpäästä on reitti).
                <div class="note">
                    Esimerkki (periaate):
                    <pre class="codeblock"><code>ssh -R 0.0.0.0:9000:127.0.0.1:3000 user@server</code></pre>
                    Etäasiakkaat voivat yhdistää etäpalvelimen porttiin <code>9000</code> (palvelimen käytännöistä riippuen).
                </div>
            </li>
            <li>
                <b>Dynaaminen ohjaus (-D)</b> — luo paikallisen SOCKS-välityspalvelimen.
                <div class="note">
                    Esimerkki:
                    <pre class="codeblock"><code>ssh -D 127.0.0.1:1080 user@server</code></pre>
                    Voit ohjata selaimen/työkalun SOCKS5-osoitteeseen <code>127.0.0.1:1080</code>.
                </div>
            </li>
        </ul>

        <h4>Sääntöjen kentät (mitä ne tarkoittavat)</h4>
        <ul class="bullets">
            <li><b>Käytössä</b> — kytkee yksittäisen säännön päälle/pois (poistamatta sitä)</li>
            <li><b>Tyyppi</b> — Paikallinen (-L), Etä (-R), Dynaaminen (-D)</li>
            <li><b>Sitomisosoite</b> — mihin kuuntelija luodaan (oletus: <code>127.0.0.1</code> vain paikalliseksi)</li>
            <li><b>Kuunteluportti</b> — avattava portti (1–65535)</li>
            <li><b>Kohdehost / Kohdeportti</b> — vain Paikallinen/Etä-säännöissä (ohitetaan Dynaamisessa)</li>
            <li><b>Kuvaus</b> — valinnainen muistiinpano</li>
        </ul>

        <div class="warn">
            <b>Tietoturvavinkki:</b> Suosi <code>127.0.0.1</code>-sidontaa paikallisissa ohjauksissa.
            Sidonta <code>0.0.0.0</code>-osoitteeseen voi altistaa ohjatun portin koko verkollesi.
        </div>

        <h4>Näin testaat ohjauksen (pikatarkistus)</h4>
        <ol>
            <li>Käynnistä palvelu etäkoneella (esim. Python-testipalvelin):<br/>
                <pre class="codeblock"><code>python3 -m http.server 18080 --bind 127.0.0.1</code></pre>
            </li>
            <li>Lisää PQ-SSH:ssa paikallinen ohjaus:<br/>
                <pre class="codeblock"><code>127.0.0.1:18888 → localhost:18080</code></pre>
            </li>
            <li>Yhdistä profiililla.</li>
            <li>Testaa paikallisella koneella:<br/>
                <pre class="codeblock"><code>curl -I http://127.0.0.1:18888/</code></pre>
            </li>
        </ol>

        <h4>Porttiohjauksen vianmääritys</h4>
        <ul class="bullets">
            <li><b>“Address already in use”</b> tarkoittaa, että kuunteluportti on jo varattu. Valitse toinen portti (esim. 18890).</li>
            <li><b>Connection reset / timeout</b> tarkoittaa usein, että kohdepalvelu ei ole käynnissä tai ei ole saavutettavissa etäpäästä.</li>
            <li><b>Etäohjaus (-R) ei toimi</b> voi olla estetty palvelimen asetuksilla (<code>AllowTcpForwarding</code>, <code>GatewayPorts</code>).</li>
        </ul>

        <div class="note">
            PQ-SSH toteuttaa ohjaukset käyttämällä järjestelmän OpenSSH:ta ja välittämällä <code>-L</code>/<code>-R</code>/<code>-D</code>-valinnat
            <code>ssh</code>-komentoa käynnistettäessä. Mitään ohjausasetuksia ei aseteta palvelimelle automaattisesti.
        </div>

        <h3>Palvelimen krypton tarkistus (diagnostiikka)</h3>
        <p>
            <b>Muokkaa profiileja…</b> -näkymässä PQ-SSH tarjoaa <b>Tarkista palvelimen crypto…</b> -painikkeen,
            jolla voit tarkastella, mitä SSH-kättely neuvottelee palvelimen kanssa.
        </p>

        <ul class="bullets">
            <li><b>Milloin se aktivoituu:</b> käytettävissä, kun olet asettanut sekä <b>Käyttäjän</b> että <b>Hostin</b> (Portti on valinnainen).</li>
            <li><b>Mitä se näyttää:</b> neuvotellun <b>KEX</b>:n, <b>host key -algoritmin</b> ja <b>salaukset</b>.</li>
            <li><b>Miten se toimii:</b> ajaa järjestelmäsi <b>OpenSSH</b>-asiakkaan verbose-tilassa (<code>ssh -vvv</code>) lyhyellä aikakatkaisulla.</li>
            <li><b>Ei vaadi tunnistautumista:</b> neuvottelu tapahtuu ennen autentikointia.</li>
            <li><b>Vain luku:</b> ei muuta palvelinta tai profiilia.</li>
        </ul>

        <div class="note">
            Jos tarkistus näyttää <b>(not found)</b>, yleisiä syitä ovat: host ei ole saavutettavissa, portti estetty, DNS-ongelma tai tuloksen jäsennys ei täsmää.
            Avaa tarkistusikkunan lisätiedot nähdäksesi raakatekstin.
        </div>

        <div class="tip">
            Vinkki: Käytä tarkistusta varmistaaksesi modernit algoritmit (esim. <code>curve25519-sha256</code>, <code>ssh-ed25519</code>) ja havaitaksesi vanhat asennukset.
        </div>
    </section>

    <section id="connect" class="card">
        <h2>Yhdistäminen</h2>
        <ol>
            <li>Valitse profiili listasta.</li>
            <li>Napsauta <b>Yhdistä</b> (tai tuplaklikkaa profiilia).</li>
            <li>Terminaali-ikkuna avautuu ja SSH käynnistyy automaattisesti.</li>
        </ol>

        <div class="note">
            Terminaali-istunnot hoitaa OpenSSH. Samanaikaisesti PQ-SSH voi avata libssh-istunnon SFTP-toimintoja varten.
        </div>
    </section>

    <section id="fleet-jobs" class="card">
        <h2>Laajotyöt (Fleet jobs) — suorita toimintoja monelle palvelimelle</h2>

        <p>
            <b>Laajotyöt</b> mahdollistavat saman toiminnon ajamisen useille tallennetuille profiileille yhdellä kertaa.
            Tämä on hyödyllistä rutiiniadmin-työssä: terveystarkistukset, palveluiden tilan tarkistukset ja hallitut uudelleenkäynnistykset.
        </p>

        <div class="callouts">
            <div class="callout">
                <div class="callout-title">Yksi toiminto → monta kohdetta</div>
                <p>Valitse 5–50 profiilia ja suorita sama työ rinnakkain.</p>
            </div>
            <div class="callout">
                <div class="callout-title">Rinnakkaisuuden hallinta</div>
                <p>Rajoita, kuinka monta hostia ajetaan yhtä aikaa (oletus: 4), jotta kuorma pysyy hallinnassa.</p>
            </div>
            <div class="callout">
                <div class="callout-title">Aikakatkaisun turva</div>
                <p>Jokaisella kohteella on komennon aikakatkaisu, jotta “jää ikuisesti” -tilanteet vältetään.</p>
            </div>
            <div class="callout">
                <div class="callout-title">Audit-jälki</div>
                <p>Laajotyöt voidaan kirjata audit-lokiin vastuun ja jäljitettävyyden vuoksi.</p>
            </div>
        </div>

        <h3>Mistä Laajotyöt löytyvät</h3>
        <ul class="bullets">
            <li>Avaa valikosta: <b>Työkalut → Laajotyöt…</b></li>
        </ul>

        <h3>Käsitteet</h3>
        <ul class="bullets">
            <li><b>Kohde</b> — yksi profiili/host, jota vasten työ ajetaan</li>
            <li><b>Toiminto</b> — mitä haluat tehdä (Aja komento, Tarkista palvelu, Käynnistä palvelu uudelleen)</li>
            <li><b>Rinnakkaisuus</b> — enimmäismäärä kohteita, jotka ajavat yhtä aikaa</li>
            <li><b>Aikakatkaisu</b> — kuinka kauan yksittäinen kohde saa ajaa ennen kuin se tulkitaan epäonnistuneeksi</li>
        </ul>

        <h3>Vaihe vaiheelta: Laajotyön ajaminen</h3>
        <ol>
            <li>Avaa <b>Työkalut → Laajotyöt…</b></li>
            <li>Valitse yksi tai useampi kohdeprofiili listasta.</li>
            <li>Valitse <b>Toiminto</b>:
                <ul class="bullets">
                    <li><b>Aja komento</b> — suorittaa shell-komennon jokaisella hostilla</li>
                    <li><b>Tarkista palvelu</b> — tarkistaa, onko systemd-palvelu aktiivinen</li>
                    <li><b>Käynnistä palvelu uudelleen</b> — käynnistää systemd-palvelun uudelleen (häiritsevä)</li>
                </ul>
            </li>
            <li>Syötä <b>Komento</b> (tai <b>Palvelun nimi</b>) toiminnon mukaan.</li>
            <li>Aseta <b>Rinnakkaisuus</b> (suositus: 2–8).</li>
            <li>(Jos näkyy) aseta <b>Aikakatkaisu</b> (suositus: 60–180 sekuntia).</li>
            <li>Napsauta <b>Suorita</b>.</li>
        </ol>

        <div class="note">
            Laajotyöt luovat erillisen SSH-yhteyden per kohde, jotta säikeiden välinen uudelleenkäyttö vältetään ja virheet pysyvät erillään.
        </div>

        <h3>Toimintojen tarkemmat tiedot</h3>
        <h4>Aja komento</h4>
        <p>Ajaa komennon jokaisella kohteella ja näyttää talteen otetut <b>stdout</b>- ja <b>stderr</b>-tulosteet.</p>
        <div class="note">
            Esimerkkejä:
            <pre class="codeblock"><code>uptime</code></pre>
            <pre class="codeblock"><code>df -h</code></pre>
            <pre class="codeblock"><code>uname -a</code></pre>
        </div>

        <h4>Tarkista palvelu (systemd)</h4>
        <p>Tarkistaa, onko systemd-palvelu aktiivinen (ei häiritse).</p>
        <div class="note">
            Esimerkki palvelunimestä:
            <pre class="codeblock"><code>nginx</code></pre>
        </div>

        <h4>Käynnistä palvelu uudelleen (systemd)</h4>
        <p>Käynnistää palvelun uudelleen (häiritsevä). PQ-SSH pyytää lisävahvistuksen ennen häiritsevien toimintojen ajamista.</p>
        <div class="warn">
            <b>Varoitus:</b> Palveluiden uudelleenkäynnistäminen voi aiheuttaa katkoja. Suosi <b>Tarkista palvelu</b> ensin.
        </div>

        <h3>Aikakatkaisut</h3>
        <ul class="bullets">
            <li>Jos kohde ylittää aikakatkaisun, se merkitään <b>Epäonnistuneeksi</b> aikakatkaisuviestillä.</li>
            <li>Muut kohteet jatkavat ajamista.</li>
            <li>Aikakatkaisu lopettaa tulosteen odottamisen; se ei luotettavasti tapa etäprosesseja.</li>
        </ul>

        <div class="tip">
            Vinkki: Pitkissä tehtävissä kuten <code>apt upgrade</code>, kasvata aikakatkaisua tai vältä Laajotyötä.
        </div>

        <h3>Rinnakkaisuus</h3>
        <div class="note">
            Suositeltu aloitus:
            <ul class="bullets">
                <li><b>Koti/labra:</b> 2–4</li>
                <li><b>Pieni laivue (10–20 palvelinta):</b> 4–8</li>
            </ul>
        </div>

        <h3>Työn peruminen</h3>
        <p>
            Napsauta <b>Peru</b> pyytääksesi perumista. Kohteet, joita ei ole vielä aloitettu, ohitetaan.
        </p>

        <h3>Tulosten ymmärtäminen</h3>
        <ul class="bullets">
            <li><b>Tila</b> — Ok / Failed / Canceled</li>
            <li><b>Kesto</b></li>
            <li><b>Tuloste</b> — lyhennetty luettavuuden vuoksi</li>
        </ul>

        <h3>Audit-lokitus (suositus Laajotöille)</h3>
        <p>Laajotyöt voidaan kirjoittaa erilliseen <b>audit-lokiin</b> jäljitettävyyttä varten.</p>

        <div class="warn">
            <b>Yksityisyys:</b> Vältä täysien komentosisältöjen tallentamista audit-lokiin, jos komennoissa voi olla salaisuuksia.
            Suosi hasheja ja minimaalista metatietoa.
        </div>
    </section>

    <!-- ✅ NEW / UPDATED SECTION: Scheduled jobs -->
    <section id="scheduled-jobs" class="card">
        <h2>Ajastetut työt (suorita komento myöhemmin tai aikataululla)</h2>

        <p>
            <b>Ajastetut työt</b> mahdollistavat komennon ja aikataulun määrittämisen ja sen asentamisen valitulle palvelinprofiilille.
            Tämä on hyödyllistä rutiinihuoltoon, viivästettyihin toimiin ja toistuviin tehtäviin (päivittäiset tarkistukset, viikoittaiset uudelleenkäynnistykset, jne.).
        </p>

        <div class="note">
            Ajastetut työt määritellään paikallisesti PQ-SSH:ssa, mutta ne suorittuvat vasta sen jälkeen, kun olet erikseen
            napsauttanut <b>Asenna palvelimelle</b>. Työn luominen tai muokkaus <b>ei</b> vaikuta etäjärjestelmään ennen asennusta.
        </div>

        <div class="tip">
            Ajastetut työt sopivat viivästettyihin tai toistuviin tehtäviin yhdellä palvelimella.
            Jos haluat suorittaa heti usealle palvelimelle, käytä <b>Työkalut → Laajotyöt…</b>.
        </div>

        <h3>Mistä Ajastetut työt löytyvät</h3>
        <ul class="bullets">
            <li>Avaa valikosta: <b>Työkalut → Ajastetut työt…</b></li>
        </ul>

        <h3>Mitä näet</h3>
        <p>
            Ajastettujen töiden ikkuna näyttää listan töistä ja niiden tilan. Jokainen rivi sisältää:
        </p>
        <ul class="bullets">
            <li><b>Nimi</b> — työn selite/nimi</li>
            <li><b>Profiili</b> — mille palvelimelle (profiilille) työ on tarkoitettu</li>
            <li><b>Tyyppi</b> — Kertaluonteinen tai Toistuva</li>
            <li><b>Milloin</b> — ajoaika (kertaluonteinen) tai aikataululauseke (toistuva)</li>
            <li><b>Komento</b> — palvelimella ajettava komento</li>
            <li><b>Asennettu</b> — onko työ asennettu etäpalvelimelle</li>
            <li><b>Käytössä</b> — onko työ käytössä paikallisesti (tuleva käyttö)</li>
        </ul>

        <h3>Asenna, Peruuta ja Poista (mitä kukin tarkoittaa)</h3>
        <ul class="bullets">
            <li>
                <b>Asenna palvelimelle</b> —
                luo tai päivittää ajastusmerkinnän etäpalvelimelle.
                Mitään etämuutoksia ei tapahdu ennen tätä vaihetta.
            </li>
            <li>
                <b>Peruuta palvelimelta</b> —
                poistaa ajastusmerkinnän, jonka PQ-SSH on aiemmin asentanut etäpalvelimelle.
            </li>
            <li>
                <b>Poista</b> —
                poistaa työn vain PQ-SSH:sta.
                Se <b>ei</b> muokkaa etäpalvelinta.
            </li>
        </ul>

        <div class="warn">
            <b>Tärkeää:</b> Jos poistat työn peruuttamatta sitä ensin, työ voi jäädä aktiiviseksi etäpalvelimelle.
        </div>

        <h3>Työtyypit</h3>

        <h4>Kertaluonteinen (suoritetaan kerran)</h4>
        <p>
            Kertaluonteinen työ ajetaan kerran tiettynä paikallisena aikana (syötetään muodossa <code>YYYY-MM-DD HH:MM</code>).
            PQ-SSH asentaa sen palvelimelle parhaalla saatavilla olevalla taustalla.
        </p>

        <h4>Toistuva (OnCalendar)</h4>
        <p>
            Toistuva työ ajetaan aikataulun mukaisesti. Kun systemd on saatavilla, PQ-SSH käyttää
            systemd:n <b>OnCalendar</b>-muotoa (esim. <code>daily</code>, <code>Mon..Fri 02:00</code>).
            Jos systemd user -timereita ei voi käyttää, PQ-SSH siirtyy cron-varavaihtoehtoon.
        </p>

        <h3>Taustan valinta (automaattinen)</h3>
        <p>
            Asennuksen aikana PQ-SSH tunnistaa etäpalvelimelta, mitkä ajastusratkaisut ovat käytettävissä.
            Paras vaihtoehto valitaan automaattisesti.
        </p>
        <ul class="bullets">
            <li><b>Suositus:</b> systemd <b>user</b> -timerit (<code>systemctl --user</code>)</li>
            <li><b>Toistuva varavaihtoehto:</b> cron (<code>crontab</code>)</li>
            <li><b>Kertaluonteinen varavaihtoehto:</b> at (<code>at</code>) tai cron, jos <code>at</code> puuttuu</li>
        </ul>

        <div class="note">
            Joissain palvelimissa <code>systemctl</code> on asennettu, mutta ei tarjoa user-DBus-istuntoa ei-interaktiivisille SSH-kirjautumisille.
            Tällöin systemd user -timerit voivat epäonnistua ja PQ-SSH käyttää cron/at-varavaihtoehtoja mahdollisuuksien mukaan.
        </div>

        <h3>Komennon suoritusympäristö</h3>
        <p>
            Ajastetut komennot suoritetaan ei-interaktiivisesti etäpalvelimella käyttäen:
        </p>
        <pre class="codeblock"><code>/bin/sh -lc 'your command'</code></pre>

        <div class="note">
            Interaktiivista terminaalia ei varata. Komennot, jotka vaativat TTY-vuorovaikutusta
            (kuten editorit tai salasanakyselyt), epäonnistuvat.
        </div>

        <h3>Esimerkkejä</h3>
        <ul class="bullets">
            <li><b>Päivittäinen levytilannekuva</b>
                <pre class="codeblock"><code>df -h &gt; ~/disk-usage.txt</code></pre>
            </li>
            <li><b>Käynnistä palvelu uudelleen yöllä (varo)</b>
                <pre class="codeblock"><code>sudo systemctl restart nginx</code></pre>
            </li>
            <li><b>Kertaluonteinen viivästetty komento</b>
                <pre class="codeblock"><code>echo "hello" &gt;&gt; ~/hello.log</code></pre>
            </li>
        </ul>

        <div class="warn">
            <b>Tietoturvahuomio:</b> Vältä salaisuuksien upottamista ajastettuihin komentoihin.
            Suosi salaisuuksien lukemista suojatuista tiedostoista tai secret manager -ratkaisuista.
        </div>
    </section>

    <section id="macros" class="card">
        <h2>Makrot (pikanäppäimet)</h2>
        <p>
            PQ-SSH tukee <b>profiilikohtaisia pikanäppäinmakroja</b>. Makro on näppäinyhdistelmä, joka lähettää komennon
            aktiiviseen SSH-terminaaliin heti (halutessa automaattisella <code>[Enter]</code>-painalluksella).
        </p>

        <h3>Mistä makrot löytyvät</h3>
        <ul class="bullets">
            <li>Avaa <b>Muokkaa profiileja…</b></li>
            <li>Valitse profiili</li>
            <li>Käytä oikean reunan <b>Pikanäppäinmakrot</b>-paneelia</li>
        </ul>

        <h3>Makron luominen</h3>
        <ol>
            <li>Napsauta <b>+</b> lisätäksesi makron.</li>
            <li>Aseta <b>Nimi</b> (suositus).</li>
            <li>Napsauta <b>Pikanäppäin</b>-kenttää ja paina näppäinyhdistelmä (esim. <code>F2</code>, <code>Alt+X</code>).</li>
            <li>Kirjoita lähetettävä <b>Komento</b>.</li>
            <li>Ota käyttöön <b>Lähetä [Enter] automaattisesti</b>, jos haluat sen ajautuvan heti.</li>
        </ol>

        <div class="note">
            Makrot ovat tarkoituksella yksinkertaisia: PQ-SSH lähettää terminaaliin pelkkää tekstiä. Se ei suorita mitään paikallisesti.
        </div>

        <h3>Makrojen käyttö</h3>
        <ul class="bullets">
            <li>Yhdistä profiililla, jossa makro on.</li>
            <li>Paina makron pikanäppäintä, kun terminaali-ikkuna on aktiivinen.</li>
            <li>PQ-SSH lähettää makrokomennon terminaaliin.</li>
        </ul>

        <h3>Paikkamerkit (muuttujat)</h3>
        <p>
            Makrot voivat sisältää <b>paikkamerkkimuuttujia</b>, jotka PQ-SSH laajentaa juuri ennen komennon lähettämistä.
        </p>

        <div class="note">
            Esimerkki:
            <pre class="codeblock"><code>echo "Connected to {USER}@{HOST}:{PORT}"</code></pre>
            laajenee muotoon:
            <pre class="codeblock"><code>echo "Connected to john@example.com:2222"</code></pre>
        </div>

        <h3>Tuetut paikkamerkit</h3>
        <ul class="bullets">
            <li><code>{PROFILE}</code> — profiilin nimi</li>
            <li><code>{USER}</code> — SSH-käyttäjä</li>
            <li><code>{HOST}</code> — isäntänimi/IP</li>
            <li><code>{PORT}</code> — portti (oletus 22)</li>
            <li><code>{TARGET}</code> — <code>user@host</code> (tai <code>user@host:port</code>, jos portti ei ole 22)</li>
            <li><code>{HOME}</code> — <code>~</code></li>
            <li><code>{KEYFILE}</code> — asetettu avaintiedoston polku (jos on)</li>
            <li><code>{DATE}</code> — tämänhetkinen päivämäärä (<code>YYYY-MM-DD</code>)</li>
            <li><code>{TIME}</code> — tämänhetkinen aika (<code>HH:MM:SS</code>)</li>
        </ul>
        <div class="note">
            <b>{KEYFILE}</b> laajenee tyhjäksi merkkijonoksi, jos profiilille ei ole asetettu avaintiedostoa.
        </div>
        <div class="note">
            <b>{TARGET}</b> käyttää muotoa <code>user@host</code> portilla 22 ja <code>user@host:port</code> muilla porteilla.
        </div>

        <h3>Aaltosulkeiden escapetus</h3>
        <ul class="bullets">
            <li><code>{{</code> muuttuu kirjaimelliseksi <code>{</code></li>
            <li><code>}}</code> muuttuu kirjaimelliseksi <code>}</code></li>
        </ul>

        <div class="note">
            Esimerkki:
            <pre class="codeblock"><code>{{{USER}}}</code></pre>
            muuttuu:
            <pre class="codeblock"><code>{root}</code></pre>
        </div>

        <div class="warn">
            <b>Tärkeää:</b> Tuntemattomat paikkamerkit jätetään ennalleen.
        </div>

        <h3>Makroesimerkkejä</h3>
        <ul class="bullets">
            <li><b>Nopea tila</b>
                <pre class="codeblock"><code>uptime</code></pre>
            </li>
            <li><b>Näytä levytila</b>
                <pre class="codeblock"><code>df -h</code></pre>
            </li>
            <li><b>Seuraa palvelulogia</b>
                <pre class="codeblock"><code>journalctl -u nginx -f</code></pre>
            </li>
            <li><b>Kontekstibanneri (paikkamerkeillä)</b>
                <pre class="codeblock"><code>echo "=== {PROFILE} :: {TARGET} ==="</code></pre>
            </li>
            <li><b>Tarkista host key -merkintä</b>
                <pre class="codeblock"><code>ssh-keygen -F {HOST}</code></pre>
            </li>
        </ul>

        <div class="tip">
            Vinkki: Suosi funktionäppäimiä (<code>F1…F12</code>) tai <code>Alt+…</code>-yhdistelmiä, jotka eivät törmää terminaalisovelluksiin kuten <code>vim</code>.
        </div>
    </section>

    <section id="settings" class="card">
        <h2>Asetukset-valikko</h2>
        <p>PQ-SSH sisältää Asetukset-ikkunan, jolla hallitset ulkoasua ja lokituksen toimintaa.</p>

        <h3>Mistä se löytyy</h3>
        <ul class="bullets">
            <li>Ylävalikosta: <b>Tiedosto → Asetukset…</b></li>
        </ul>

        <h3>Mitä tapahtuu, kun tallennat</h3>
        <ul class="bullets">
            <li>Asetukset tallennetaan ja otetaan käyttöön heti.</li>
            <li>Teemamuutokset tulevat voimaan välittömästi (ei uudelleenkäynnistystä).</li>
            <li>Lokitasomuutokset tulevat voimaan välittömästi.</li>
        </ul>

        <div class="note">
            Asetukset tallennetaan <code>QSettings</code>-mekanismilla sovelluksen nimen ja organisaation alle, jotka PQ-SSH määrittelee.
        </div>
    </section>

    <section id="themes" class="card">
        <h2>Teemat</h2>
        <p>
            Teemat hallitsevat pääkäyttöliittymän ulkoasua (listat, painikkeet, ikkunat, välilehdet).
            Terminaalin värit määritellään erikseen profiilissa valitulla <b>Terminaaliteemalla</b>.
        </p>

        <h3>Saatavilla olevat teemat</h3>
        <ul class="bullets">
            <li><b>CPUNK Dark</b> — tumma UI CPUNK-neonkorostuksilla</li>
            <li><b>CPUNK Orange</b> — tumma UI oransseilla korostuksilla</li>
            <li><b>Windows Basic</b> — vaalea/neutraali UI (klassinen työpöytätuntuma)</li>
            <li><b>CPUNK Neo</b> — sovelluksen mukana tuleva lisäteema CPUNK-tyylillä</li>
        </ul>

        <h3>Näin vaihdat teeman</h3>
        <ol>
            <li>Avaa <b>Tiedosto → Asetukset…</b></li>
            <li>Valitse <b>Sovellusteema</b></li>
            <li>Napsauta <b>Tallenna</b></li>
        </ol>

        <div class="tip">
            Jos et näe selvää muutosta, varmista että napsautit <b>Tallenna</b>. PQ-SSH ottaa teeman käyttöön, kun asetukset tallennetaan.
        </div>
    </section>

    <section id="file-transfer" class="card">
        <h2>Tiedostonsiirto</h2>

        <table class="twocol" role="presentation">
            <tr>
                <td class="colText">
                    <p>
                        PQ-SSH sisältää sisäänrakennetun tiedostonsiirtotyönkulun. Se käyttää erillistä <b>libssh</b>-istuntoa SFTP-toimintoihin,
                        kun taas interaktiivinen terminaali käyttää OpenSSH:ta.
                    </p>

                    <h3>Tiedostot-välilehti</h3>
                    <p>
                        Pääikkunassa on <b>Tiedostot</b>-välilehti <b>Loki</b>-välilehden vieressä.
                        Kun SFTP-yhteys on muodostettu, voit selata etätiedostojärjestelmää ja tehdä siirtoja.
                    </p>

                    <ul class="bullets">
                        <li>Jos libssh-yhteys onnistuu, Tiedostot-välilehti aktivoituu ja etälistaus toimii.</li>
                        <li>Jos libssh epäonnistuu, SSH-terminaali toimii normaalisti, mutta SFTP-toiminnot ovat pois käytöstä.</li>
                    </ul>

                    <h3>Vedä &amp; pudota -lähetykset</h3>
                    <ul class="bullets">
                        <li>Jos libssh on yhdistetty, pudotetut tiedostot ladataan etäpuolen nykyiseen työhakemistoon (<code>$PWD</code>).</li>
                        <li>Jos libssh ei ole yhdistetty, PQ-SSH tallentaa pudotetun tiedoston paikallisesti turvalliseen varakansioon.</li>
                    </ul>

                    <h3>Paikallinen varakansio</h3>
                    <pre class="codeblock"><code>~/pqssh_drops/</code></pre>

                    <div class="warn">
                        <b>Huom:</b> Varakansio estää “hiljaisen epäonnistumisen”, kun käyttäjä odottaa pudotuksen tekevän jotain.
                        Se ei ole synkronointikansio.
                    </div>

                    <h3>Yleisiä syitä, miksi SFTP on pois käytöstä</h3>
                    <ul class="bullets">
                        <li>Autentikointi epäonnistuu libssh-istunnossa</li>
                        <li>Verkko-/palomuuriongelmat</li>
                        <li>Profiilissa käytetään avaintyyppiä, jota PQ-SSH:n libssh-polku ei vielä tue</li>
                    </ul>
                </td>

                <td class="colImg">
                    <div class="figure">
                        <img src="qrc:/docs/img/files.png" alt="Tiedostot-välilehti (SFTP)" width="450"/>
                        <div class="figcap"><b>Tiedostot-välilehti</b> — selaa ja siirrä tiedostoja SFTP:n kautta (libssh-istunto).</div>
                    </div>
                </td>
            </tr>
        </table>
    </section>

    <section id="pq-status" class="card">
        <h2>PQ-tilan ilmaisin</h2>
        <p>
            PQ-SSH ajaa pikatarkistuksen selvittääkseen, tukeeko etäpalvelin PQ-kykyistä avainvaihtoa.
            Tämä <b>ei</b> muuta palvelimen asetuksia; se on pelkkä informaatio.
        </p>

        <h3>Mitä merkit tarkoittavat</h3>

        <div class="note">
            <b>Tärkeää:</b> PQ-SSH voi käyttää <b>kahta eri SSH-pinoa</b> samaan aikaan:
            <ul class="bullets">
                <li><b>Terminaali-SSH</b> käyttää järjestelmäsi <b>OpenSSH</b>:ta (pääasiallinen interaktiivinen istunto).</li>
                <li><b>SFTP</b> käyttää valinnaista <b>libssh</b>-istuntoa (vain Tiedostot-välilehteen / siirtoihin).</li>
            </ul>
            Koska pinot ovat eri, ne voivat neuvotella <b>eri algoritmit</b>.
        </div>

        <h4>PQ-tuki</h4>
        <div class="badges">
            <span class="badge ok">PQ-tuki: KYLLÄ</span>
            <span class="badge off">PQ-tuki: EI</span>
            <span class="badge wait">PQ: tarkistetaan…</span>
        </div>

        <ul class="bullets">
            <li><b>PQ-tuki: KYLLÄ</b> — tarkistus havaitsi palvelimen tarjoavan PQ-/hybridiavainvaihdon.</li>
            <li><b>PQ-tuki: EI</b> — palvelin ei todennäköisesti tarjoa tarkistettua PQ-/hybridi-KEX:ää.</li>
            <li><b>PQ: tarkistetaan…</b> — tarkistus käynnissä.</li>
        </ul>

        <h4>SSH KEX vs SFTP KEX</h4>
        <p>
            PQ-SSH näyttää neuvotellun avainvaihdon erikseen kahdelle yhteydelle:
        </p>

        <ul class="bullets">
            <li>
                <b>SSH KEX</b> — neuvottelee <b>OpenSSH</b> (terminaali-istunto).
                Tämä on tärkein interaktiiviselle shellillesi.
            </li>
            <li>
                <b>SFTP KEX</b> — neuvottelee <b>libssh</b> (SFTP-istunto Tiedostot-välilehdelle).
            </li>
        </ul>

        <div class="note">
            <b>libssh-rajoite:</b> vaikka terminaali-istunto neuvottelisi PQ-/hybridi-KEX:n,
            libssh-pohjainen SFTP-istunto voi silti näyttää <b>klassisia</b> algoritmeja kirjastotuen rajoitteiden vuoksi.
            Tämä on odotettua eikä “alenna” OpenSSH-terminaali-istuntoasi.
        </div>

        <h4>Diagnostiikka Loki-välilehdellä</h4>
        <p>
            Kun <b>PQ debug</b> on käytössä, saatat nähdä rivejä kuten:
        </p>
        <pre class="codeblock"><code>[PQ-PROBE] ... ssh ... true
[SFTP-KEX] Classical (libssh limitation) → X25519 (Curve25519)</code></pre>

        <div class="tip">
            Vinkki: Jos <b>SSH KEX</b> näyttää PQ-/hybridiä mutta <b>SFTP KEX</b> näyttää klassista, se tarkoittaa tyypillisesti:
            palvelin tukee PQ-/hybridiä OpenSSH:ssa, mutta SFTP-kirjastopolku ei pysty neuvottelemaan sitä.
        </div>

        <div class="note">
            Indikaattorit ovat parhaaseen yritykseen perustuvia UI-vihjeitä; PQ-SSH ei muuta SSH-palvelimen asetuksia eikä pakota PQ-tilaa.
        </div>
    </section>

    <section class="card" id="key-install">
        <h2>Julkisen avaimen asentaminen palvelimelle</h2>
        <p>
            PQ-SSH voi asentaa <b>OpenSSH-julkisen avaimen</b> suoraan etäpalvelimen
            <code>~/.ssh/authorized_keys</code>-tiedostoon turvallisesti ja ei-tuhoavasti.
        </p>

        <p>Tämä toiminto löytyy:</p>
        <ul class="bullets">
            <li><b>Avaimet → Asenna julkinen avain palvelimelle…</b> (päävalikko)</li>
            <li><b>Avaingeneraattori → Avaimet-välilehti → Asenna…</b> (asenna valittu avain)</li>
        </ul>

        <h3>Mitä näet (vahvistusvaihe)</h3>
        <p>Ennen kuin palvelimella muutetaan mitään, PQ-SSH näyttää vahvistusikkunan, jossa on:</p>
        <ul class="bullets">
            <li><b>Kohdeprofiilin nimi</b></li>
            <li><b>Käyttäjä / host / portti</b></li>
            <li><b>Etäpolku:</b> <code>~/.ssh/authorized_keys</code></li>
            <li><b>Avaintyyppi</b> (esim. <code>ssh-ed25519</code>)</li>
            <li><b>Avaimen esikatselu</b> (lyhyt ote avaimesta)</li>
        </ul>

        <div class="note">Mitään ei tapahdu, ellet nimenomaisesti vahvista.</div>

        <h3>Mitä palvelimella tapahtuu</h3>
        <p>Vahvistuksen jälkeen PQ-SSH yhdistää SSH/SFTP:llä ja tekee seuraavat vaiheet:</p>

        <ol>
            <li>
                <b>Varmistaa, että SSH-hakemisto on olemassa</b>
                <pre class="codeblock"><code>mkdir -p ~/.ssh
chmod 700 ~/.ssh</code></pre>
            </li>
            <li>
                <b>Lukee olemassa olevan <code>authorized_keys</code>-tiedoston (jos löytyy)</b>
                <p>Jos sama avain on jo olemassa, mitään ei muuteta.</p>
            </li>
            <li>
                <b>Luo aikaleimatun varmuuskopion (jos tiedosto on olemassa)</b>
                <div class="warn">
                    Varmuuskopio on pakollinen. Jos varmuuskopiointi epäonnistuu, avaimen asennus keskeytetään.
                </div>
            </li>
            <li>
                <b>Lisää avaimen vain, jos se puuttuu</b>
                <p>Tuplia ei koskaan lisätä.</p>
            </li>
            <li>
                <b>Korjaa oikeudet</b>
                <pre class="codeblock"><code>chmod 600 ~/.ssh/authorized_keys</code></pre>
            </li>
        </ol>

        <h3>Turvatakuut</h3>
        <ul class="bullets">
            <li>Olemassa olevat avaimet säilyvät</li>
            <li>Varmuuskopio ennen muutosta</li>
            <li>Ei tupla-avaimia</li>
            <li>Oikeat SSH-oikeudet pakotetaan</li>
            <li>Salasanoja tai yksityisiä avaimia ei koskaan ladata</li>
        </ul>
    </section>

    <section id="logging" class="card">
        <h2>Lokitus &amp; debug</h2>

        <table class="twocol" role="presentation">
            <tr>
                <td class="colText">
                    <h3>Lokitustasot</h3>
                    <p>Lokituksen tarkkuutta voi säätää kohdasta <b>Tiedosto → Asetukset…</b>:</p>
                    <ul class="bullets">
                        <li><b>Vain virheet</b> — minimaalinen lokitus</li>
                        <li><b>Normaali</b> — suositeltu oletus</li>
                        <li><b>Debug</b> — tarkka lokitus vianmääritykseen</li>
                    </ul>

                    <h3>Avaa lokitiedosto</h3>
                    <p>Käytä valikkoa: <b>Näytä → Avaa lokitiedosto</b></p>
                    <pre class="codeblock"><code>~/.local/share/pq-ssh/logs/pq-ssh.log</code></pre>

                    <h3>PQ debug -tila (UI)</h3>
                    <p>
                        Ota <b>PQ debug</b> käyttöön alariviltä nähdäksesi lisädiagnostiikkaa
                        (SSH-komennon yksityiskohdat, teemalistat, matalan tason viestit).
                    </p>

                    <div class="warn">
                        <b>Yksityisyys:</b> PQ-SSH ei kirjaa salasanoja tai yksityisten avainten sisältöä.
                        Debug-tuloste voi silti sisältää hosteja ja tiedostopolkuja.
                    </div>
                </td>

                <td class="colImg">
                    <div class="figure">
                        <img src="qrc:/docs/img/auditlog.png" alt="Audit-lokin katselu" width="450" />
                        <div class="figcap"><b>Audit-loki</b> — tarkastele toimintoja (erityisesti Laajotyöt) jäljitettävyyden vuoksi.</div>
                    </div>
                </td>
            </tr>
        </table>
    </section>

    <section class="card">
        <h2>Avaimet &amp; vanhenemisvaroitukset</h2>
        <p>Avaa <b>Avaimet → Avaingeneraattori…</b> luodaksesi/hallitaksesi avaimia.</p>

        <ul class="bullets">
            <li>Käynnistyksessä PQ-SSH voi merkitä vanhentuneet avaimet automaattisesti metatietoihin.</li>
            <li>Jos vanhentuneita avaimia on, tila-alueella näytetään varoitus.</li>
            <li>Vaihda avaimet säännöllisesti parhaan tietoturvan saavuttamiseksi.</li>
        </ul>
    </section>

    <section id="troubleshooting" class="card">
        <h2>Vianmääritys</h2>

        <details>
            <summary>Asennus epäonnistui: “Failed to connect to bus” / “No medium found”</summary>
            <ul class="bullets">
                <li>
                    Tämä tarkoittaa, että <code>systemctl --user</code> on olemassa, mutta palvelimella ei ole käyttäjän DBus-istuntoa käytettävissä.
                </li>
                <li>
                    Yleistä headless-/minimaalipalvelimilla ilman user lingering -asetusta.
                </li>
                <li>
                    Korjaa palvelimella kerran (suositus):
                    <pre class="codeblock"><code>sudo loginctl enable-linger &lt;user&gt;</code></pre>
                </li>
                <li>
                    Vaihtoehtoisesti PQ-SSH käyttää cron- tai at-varavaihtoehtoa, jos saatavilla.
                </li>
            </ul>
        </details>

        <details>
            <summary>Laajotyö epäonnistui yhdellä hostilla</summary>
            <ul class="bullets">
                <li>Avaa <b>Näytä → Avaa lokitiedosto</b> nähdäksesi tarkat virheet.</li>
                <li>Kokeile ajaa sama työ vain kyseiselle hostille toistaaksesi tilanteen.</li>
                <li>Pienennä <b>Rinnakkaisuutta</b>, jos moni host epäonnistuu yhtä aikaa.</li>
                <li>Kasvata <b>Aikakatkaisua</b>, jos komento on hidas kyseisellä hostilla.</li>
            </ul>
        </details>

        <details>
            <summary>Laajotyön uudelleenkäynnistys on vaarallinen — miten tehdä se turvallisesti?</summary>
            <ul class="bullets">
                <li>Aja ensin <b>Tarkista palvelu</b> ymmärtääksesi nykytilan.</li>
                <li>Käynnistä uudelleen ensin yksi host, varmista toiminta, ja laajenna vasta sitten.</li>
                <li>Vältä uudelleenkäynnistyksiä käyttöjärjestelmäpäivitysten tai pakettiasennusten aikana.</li>
                <li>Käytä varovaista rinnakkaisuutta (2–4) tuotantoympäristössä.</li>
            </ul>
        </details>

        <details>
            <summary>Teeman vaihto ei tullut voimaan</summary>
            <ul class="bullets">
                <li>Avaa <b>Tiedosto → Asetukset…</b>, valitse teema ja napsauta <b>Tallenna</b>.</li>
                <li>Tarvittaessa sulje ja avaa Asetukset-ikkuna uudelleen ja kokeile taas.</li>
            </ul>
        </details>

        <details>
            <summary>Yhteys epäonnistuu heti</summary>
            <ul class="bullets">
                <li>Tarkista host/IP ja portti profiilista.</li>
                <li>Tarkista lokitiedosto (Ohje → Avaa lokitiedosto).</li>
                <li>Ota <b>PQ debug</b> käyttöön nähdäksesi tarkat SSH-diagnostiikat.</li>
            </ul>
        </details>

        <details>
            <summary>PQ näyttää OFF</summary>
            <ul class="bullets">
                <li>Palvelin ei todennäköisesti tarjoa tarkistettua PQ-avainvaihtoa.</li>
                <li>Tämä on informatiivista; normaali SSH voi silti olla turvallinen käytännöistäsi riippuen.</li>
            </ul>
        </details>

        <details>
            <summary>Tiedostot-välilehti / SFTP on pois käytöstä</summary>
            <ul class="bullets">
                <li>libssh-istunto voi epäonnistua, vaikka terminaali-SSH toimisi.</li>
                <li>Jotkin avaintyypit eivät ole vielä tuettuja libssh-polussa.</li>
                <li>Tarkista lokit autentikointi- tai yhteysvirheiden varalta.</li>
            </ul>
        </details>

        <details>
            <summary>Vedä &amp; pudota tallentui paikallisesti eikä ladannut</summary>
            <ul class="bullets">
                <li>Tämä tarkoittaa, että SFTP/libssh ei ollut yhdistetty pudotushetkellä.</li>
                <li>Varmista, että SFTP on valmiina ja yritä uudelleen, tai käytä Tiedostot-välilehden siirtoja.</li>
                <li>Paikallinen varakansio: <code>~/pqssh_drops/</code></li>
            </ul>
        </details>

        <details>
            <summary>Makron pikanäppäin ei laukea</summary>
            <ul class="bullets">
                <li>Varmista, että makrossa on <b>sekä</b> Pikanäppäin että Komento.</li>
                <li>Varmista, että terminaali-ikkuna on aktiivinen ikkuna.</li>
                <li>Vältä pikanäppäimiä, joita terminaalisovellukset käyttävät (esim. osa <code>Ctrl+…</code>-yhdistelmistä <code>vim</code>:ssä).</li>
                <li>Kokeile funktionäppäintä kuten <code>F2</code> tai <code>Alt+…</code>-yhdistelmää.</li>
            </ul>
        </details>

        <details>
            <summary>Paikkamerkit eivät laajentuneet</summary>
            <ul class="bullets">
                <li>Varmista, että käytit tuettuja tokeneita kuten <code>{HOST}</code>, <code>{USER}</code>, <code>{PORT}</code>.</li>
                <li>Tuntemattomat paikkamerkit jätetään ennalleen.</li>
            </ul>
        </details>

        <details>
            <summary>Liikaa debug-tulostetta käyttöliittymässä</summary>
            <ul class="bullets">
                <li>Kytke <b>PQ debug</b> pois päältä.</li>
                <li>Sovellus piilottaa oletuksena meluisia rivejä, kuten SSH-komentokääreitä.</li>
            </ul>
        </details>
    </section>

    <footer class="footer">
        <div class="muted">© CPUNK Project — PQ-SSH käyttöohje</div>
    </footer>
</main>
</body>
</html>
